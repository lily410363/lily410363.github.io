setwd("~/前端程式設計/HW/hw3 個人履歷+final/lily410363.github.io/final/用R畫地圖")
rm(list = ls())
library(spdep)
library(rgdal)
library(GISTools)
library(zoom)
TWPOP <- readOGR(dsn = ".", layer = "Popn_TWN2", encoding="utf8")
TWPOP$Area <- poly.areas(TWPOP)/1000000  #km2
Popn <- as.numeric(as.character(TWPOP$A15A64_CNT+TWPOP$A0A14_CNT+TWPOP$A65UP_CNT))
TWPOP$POP = Popn
TWPOP$ODD = as.numeric(TWPOP$A65UP_CNT/TWPOP$POP)
ODD=TWPOP$ODD
#我自己畫
par(bg = 'transparent')
my.palette <- brewer.pal(n = 7, name = "OrRd")
vacant.shades = auto.shading(TWPOP$ODD, n=7, cols=my.palette, cutter=rangeCuts,)
#    畫圖              sp               variable
choropleth(TWPOP,  TWPOP$ODD,  shading=vacant.shades ,border='transparent',xlim=c(-50172.1 ,413851.5),ylim=c(2389490 ,2941302))
plot(drawTW,add=T,border='grey',cex=0.4)
choro.legend(-151102.2,2492096,sh = vacant.shades ,cex=0.3)
#lm.palette <- colorRampPalette(c("white","orange", "red"), space = "rgb")
drawTW=gUnaryUnion(TWPOP,as.character(TWPOP$COUNTY))
plot(drawTW,add=T,border='grey',cex=0.4)
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
choro.legend(-151102.2,2492096,sh = vacant.shades ,cex=0.3)
choro.legend(-151102.2,2492096,sh = vacant.shades ,cex=0.3)
summary(TWPOP$ODD)
(0.30-0.07)/8
library(RColorBrewer)
library(rgdal)
summary(TWPOP$ODD)
mycolours <- brewer.pal(8, "Blues")
mybreaks <- c(0.07, 0.07+0.02875,0.07+0.02875*2, 0.07+0.02875*3, 0.07+0.02875*4, 0.07+0.02875*5, 0.30)
cut(TWPOP$ODD, mybreaks)
mycolourscheme <- mycolours[findInterval(TWPOP$ODD, vec = mybreaks)]
plot(TWPOP, col = mycolourscheme, cex = 5)
legend(-119, 31.5, legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.8, title = "老人比例")
plot(TWPOP, col = mycolourscheme, cex = 10,border='transparent',xlim=c(-50172.1 ,413851.5),ylim=c(2389490 ,2941302))
legend(-119, 31.5, legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.8, title = "老人比例")
plot(drawTW,add=T,border='grey',cex=0.4)
legend(-151102.2,2492096,legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.8, title = "老人比例")
legend(-151102.2,2492096,legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.3, title = "老人比例")
legend(-151102.2,2492096,legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.4, title = "老人比例")
mycolours <- brewer.pal(8, "OrRd")
mybreaks <- c(0.07, 0.07+0.02875,0.07+0.02875*2, 0.07+0.02875*3, 0.07+0.02875*4, 0.07+0.02875*5, 0.30)
cut(TWPOP$ODD, mybreaks)
mycolourscheme <- mycolours[findInterval(TWPOP$ODD, vec = mybreaks)]
plot(TWPOP, col = mycolourscheme, cex = 10,border='transparent',xlim=c(-50172.1 ,413851.5),ylim=c(2389490 ,2941302))
plot(drawTW,add=T,border='grey',cex=0.4)
legend(-151102.2,2492096,legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.4, title = "老人比例")
#summary(TWPOP$ODD)
par(bg = 'transparent')
mycolours <- brewer.pal(8, "OrRd")
mybreaks <- c(0.07, 0.07+0.02875,0.07+0.02875*2, 0.07+0.02875*3, 0.07+0.02875*4, 0.07+0.02875*5, 0.30)
cut(TWPOP$ODD, mybreaks)
mycolourscheme <- mycolours[findInterval(TWPOP$ODD, vec = mybreaks)]
plot(TWPOP, col = mycolourscheme, cex = 10,border='transparent',xlim=c(-50172.1 ,413851.5),ylim=c(2389490 ,2941302))
plot(drawTW,add=T,border='grey',cex=0.4)
legend(-151102.2,2492096,legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.5, title = "老人比例")
legend(-151102.2,2493096,legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.5, title = "老人比例")
legend(-151102.2,2503096,legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.5, title = "老人比例")
legend(-151102.2,2583096,legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.5, title = "老人比例")
legend(-151102.2,2553096,legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.5, title = "老人比例")
par(bg = 'transparent')
mycolours <- brewer.pal(8, "OrRd")
mybreaks <- c(0.07, 0.07+0.02875,0.07+0.02875*2, 0.07+0.02875*3, 0.07+0.02875*4, 0.07+0.02875*5, 0.30)
cut(TWPOP$ODD, mybreaks)
mycolourscheme <- mycolours[findInterval(TWPOP$ODD, vec = mybreaks)]
plot(TWPOP, col = mycolourscheme, cex = 10,border='transparent',xlim=c(-50172.1 ,413851.5),ylim=c(2389490 ,2941302))
plot(drawTW,add=T,border='grey',cex=0.4)
legend(-151102.2,2553096,legend = levels(cut(TWPOP$ODD, mybreaks)), fill = mycolourscheme, cex = 0.5, title = "老人比例")
# ssplot
library(sp)
library(RColorBrewer)
mycolours <- brewer.pal(8, "YlOrRd")
spplot(TWPOP,"ODD", par.settings = list(axis.line = list(col ="transparent")), cuts = 5, col ="transparent", col.regions = mycolours)
tm_shape(TWPOP) + tm_polygons(col='ODD', palette = "Spectral") + tm_style_classic() + tm_scale_bar(position = c("right", "top"))
#TMap
library(tmap)
tm_shape(TWPOP) + tm_polygons(col='ODD', palette = "Spectral") + tm_style_classic() + tm_scale_bar(position = c("right", "top"))
#TMap
library(tmap)
install.packages("tmap")
#TMap
library(tmap)
View(TWPOP)
tm_shape(TWPOP) + tm_polygons(col='ODD', palette = "Spectral") + tm_style_classic() + tm_scale_bar(position = c("right", "top"))
tm_shape(TWPOP) + tm_polygons(col='ODD', palette = "Spectral") + tm_scale_bar(position = c("right", "top"))
tm_shape(TWPOP) + tm_polygons(col='ODD', palette =mycolours) + tm_scale_bar(position = c("right", "top"))
